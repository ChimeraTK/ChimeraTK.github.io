<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ChimeraTK-ApplicationCore: Technical specification: Exception handling for device runtime errors</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ChimeraTK_Logo_whitebg.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChimeraTK-ApplicationCore
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('spec_execption_handling.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Technical specification: Exception handling for device runtime errors </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>DRAFT VERSION, WRITE-UP IN PROGRESS!</b></p>
<h1><a class="anchor" id="spec_execptionHandling_intro"></a>
A. Introduction</h1>
<ul>
<li>1. Exceptions are handled by ApplicationCore in a way that the application developer does not need to care much about it.</li>
<li>2. ChimeraTK::runtime_error exceptions are caught by the framework and are reported to the <a class="el" href="class_chimera_t_k_1_1_device_module.html" title="Implementes access to a ChimeraTK::Device. ">DeviceModule</a>.</li>
<li>3. The <a class="el" href="class_chimera_t_k_1_1_device_module.html" title="Implementes access to a ChimeraTK::Device. ">DeviceModule</a> handles this exception and periodically tries to reopen the device.</li>
<li>4. Communication with the faulty device is <em>skipped</em>, <em>frozen</em> or <em>delayed</em> until the device is functional again (see <a class="el" href="spec_execption_handling.html#spec_exceptionHandling_intro_terminology">A.9</a>).</li>
<li>5. In case of several devices only the faulty device is affected.</li>
<li>6. Faulty devices do not prevent the application from starting, only the parts of the application that depend on the fault device are waiting for the device to come up.</li>
<li>7. Input variables of ApplicationModules which cannot be read due to a faulty device will set and propagate the DataValidity::faulty flag (see also the <a class="el" href="spec_data_validity_propagation.html">Technical specification: data validity propagation</a>).</li>
<li>8. When the device becomes functional, it will be (re)initialised by using application-defined initialisation handlers and also recover the last known values of its process variables.</li>
</ul>
<h2><a class="anchor" id="spec_exceptionHandling_intro_terminology"></a>
A.9 Special terminology used in this document</h2>
<ul>
<li>9.1 A <em>read operation</em> might be <em>skipped</em>. It means there will be no new data because the operation will not take place at all. Instead, the <em>function called returns immediately</em> and data is marked as DataValidity::faulty. Note: This term is also used if there is no new data because a running operation is interrupted by an exception.</li>
<li><a class="anchor" id="a_9_2"></a>9.2 A <em>read operation</em> might be <em>frozen</em>. This means, the <em>function called will not return until the fault state is resolved</em> and the operation is executed. Freezing only happens on operations with a pre-existing fault state (*).</li>
<li>9.3 A <em>write operation</em> might be <em>delayed</em>. This means, the operation will not be executed immediately and <em>the calling thread continues</em>. The operation will be asynchronosuly executed when the fault state is resolved. Note that the VersionNumber specified in the write operation will be retained and also used for the delayed write operation.</li>
<li>9.4 Whenever a write operation or a call to write() is mentioned, destructive writes via writeDestructively() are included. The destructive write optimisation makes no difference for the exception handling.</li>
</ul>
<h2><a class="anchor" id="spec_exceptionHandling_intro_comments"></a>
(*) Comments</h2>
<ul>
<li><a class="el" href="spec_execption_handling.html#a_9_2">9.2</a> If the device was ok and an exception occurs during the operation, it will be skipped.</li>
</ul>
<h1><a class="anchor" id="spec_execptionHandling_behaviour"></a>
B. Behavioural description</h1>
<ul>
<li>1. All ChimeraTK::runtime_error exceptions thrown by device register accessors are handled by the framework and are never exposed to user code in ApplicationModules.<ul>
<li><a class="anchor" id="b_1_1"></a>1.1 ChimeraTK::logic_error exceptions are left unhandled and will terminate the application. These errors may only occur in the (re-)initialisation phase (up to the point where all devices are opened and initialised) and point to a severe configuration error which is not recoverable. <a class="el" href="spec_execption_handling.html#comment_b_1_1">(*)</a></li>
<li><a class="anchor" id="b_1_2"></a>1.2 <b>Exception handling and DataValidity flag propagation is implemented such that it is transparent to a module whether it is directly connected to a device, or whether a fanout or another application module is in between.</b> This is the central requirement from which most other requirements are derived.</li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">index</a></li>
    <li class="footer">Generated on Wed Jun 17 2020 03:54:12 for ChimeraTK-ApplicationCore by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
